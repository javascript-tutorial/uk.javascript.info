# Зворотні посилання в шаблоні: \N і \k<ім’я>

Вміст груп захоплення `pattern:(...)` можна використовувати не тільки в резульаті пошуку чи рядку заміни, а й також безпосередньо у самому шаблоні.

## Зворотнє посилання за номером: \N

До групи можна посилатися в шаблоні використовуючи `pattern:\N`, де `N` - номер групи.

Для того, аби зрозуміти, чим це може бути корисним, давайте розглянемо приклад.

Потрібно знайти рядки в лапках: або в одинарних `subject:'...'`, або в подвійних `subject:"..."` -- обидва варіанти повинні збігатися.

Як їх знайти?

Ми можемо розмістити обидва типи лапок у квадратних дужках: `pattern:['"](.*?)['"]`, але цей вираз знайде рядки зі змішаними лапками, наприклад `match:"...'` і `match:'..."`. Це призведе до неправильних збігів, коли один тип лапок буде в середині інших, наприклад в рядку `subject:"Яке твоє ім'я?"`:

```js run
let str = `Він запитав: "Яке твоє ім'я?".`;

let regexp = /['"](.*?)['"]/g;

// Результат не той, який ми б хотіли мати
alert( str.match(regexp) ); // "Яке твоє ім'
```

Як видно, шаблон знайшов початкову подвійну лапку `match:"`, потім текст, включно до наступної одинарної лапки `match:'`, опісля чого пошук завершився.

Щоб бути впевненим, що шаблон шукає таку ж кінцеву лапку, як і початкову, можемо обернути початкові лапки в групу захвату і задіяти зворотнє посилання: `pattern:(['"])(.*?)\1`.

Ось правильний код:

```js run
let str = `Він запитав: "Яке твоє ім'я?".`;

*!*
let regexp = /(['"])(.*?)\1/g;
*/!*

alert( str.match(regexp) ); // "Яке твоє ім'я?"
```

Все працює! Механізм регулярних виразів знаходить першу лапку `pattern:(['"])` та запамʼятовує її. Це перша група захоплення.

Далі в шаблоні `pattern:\1` означає: "знайти такий же текст, як і в першій групі", що в нашому випадку - таку ж саму лапку.

Подібно до цього, `pattern:\2` означало б вміст другої групи, `pattern:\3` - 3-ї групи, і так далі.

```smart
Ми не можемо посилатися на групу, якщо в ній задіяно `?:`. Групи, які були виключені із захоплення `(?:...)`, не запамʼятовуються механізмом регулярних виразів.
```

```warn header="Не переплутайте: в шаблоні `pattern:\1`, при заміні: `pattern:$1`"
У рядку заміни використовується знак долара: `pattern:$1`, а в шаблоні - обернена коса риска `pattern:\1`.
```

## Зворотнє посилання за назвою: `\k<імʼя>`

Якщо регулярний вираз має багато дужок, досить зручно в такому випадку давати їм імена.

Для посилання на іменовану групу можна використовувати `pattern:\k<імʼя>`.

У наведеному нижче прикладі група з лапками називається `pattern:?<quote>`, тому звернення до нього буде `pattern:\k<quote>`:

```js run
let str = `Він запитав: "Яке твоє ім'я?".`;

*!*
let regexp = /(?<quote>['"])(.*?)\k<quote>/g;
*/!*

alert( str.match(regexp) ); // "Яке твоє ім'я?"
```
